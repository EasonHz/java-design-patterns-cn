# æŠ½è±¡å·¥å‚

## æ„å›¾

æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— éœ€æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚

## è¯´æ˜

**ğŸ¥ä¸¾ä¸ªæ —å­**

> ä¸ºäº†åˆ›é€ ä¸€ä¸ªç‹å›½ï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªå…·æœ‰å…±åŒç‰¹å¾çš„å¯¹è±¡ã€‚ç²¾çµç‹å›½éœ€è¦ç²¾çµå›½ç‹ã€ç²¾çµåŸå ¡å’Œç²¾çµå†›é˜Ÿï¼Œè€Œå…½äººç‹å›½éœ€è¦å…½äººå›½ç‹ã€å…½äººåŸå ¡å’Œå…½äººå†›é˜Ÿã€‚ç‹å›½ä¸­çš„ç‰©ä½“ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ã€‚

**ğŸ¥ç®€å•çš„è¯´**

> æŠ½è±¡å·¥å‚æ¨¡å¼æä¾›äº†ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥å°è£…ä¸€ç»„å…·æœ‰å…±åŒç‰¹å¾çš„å•ä¸ªå·¥å‚ï¼Œè€Œæ— éœ€æŒ‡å®šå®ƒä»¬çš„å…·ä½“å®ç°ç±»

ğŸ¥**ç¼–ç¨‹ç¤ºä¾‹**

é¦–å…ˆï¼Œæ ¹æ®ä¸Šé¢çš„ä¾‹å­ï¼Œä¸ºç‹å›½ä¸­çš„å¯¹è±¡æä¾›ä¸€äº›æ¥å£å’Œå®ç°

```java
/**
 * åŸå ¡æ¥å£
 */
public interface Castle {
  String getDescription();
}
/**
 * å›½ç‹æ¥å£
 */
public interface King {
  String getDescription();
}
/**
 * å†›é˜Ÿæ¥å£
 */
public interface Army {
  String getDescription();
}

// ç²¾çµå…·ä½“å®ç° ->
public class ElfCastle implements Castle {
  static final String DESCRIPTION = "è¿™æ˜¯ä¸€ä¸ªç²¾çµçš„åŸå ¡!";
  @Override
  public String getDescription() {
    return DESCRIPTION;
  }
}
public class ElfKing implements King {
  static final String DESCRIPTION = "è¿™æ˜¯ä¸€ä½ç²¾çµç‹!";
  @Override
  public String getDescription() {
    return DESCRIPTION;
  }
}
public class ElfArmy implements Army {
  static final String DESCRIPTION = "è¿™æ˜¯ä¸€æ”¯ç²¾çµå†›é˜Ÿ!";
  @Override
  public String getDescription() {
    return DESCRIPTION;
  }
}

// å…½äººçš„å…·ä½“å®ç°ä¹Ÿç±»ä¼¼ -> ...

```

ç„¶åæˆ‘ä»¬å°±æœ‰äº†ç‹å›½å·¥å‚çš„æŠ½è±¡å’Œå®ç°ã€‚

```java
public interface KingdomFactory {
  //ç»™ç‹å›½åˆ›å»ºä¸€ä¸ªåŸå ¡
  Castle createCastle();
  //ç»™ç‹å›½ä»»å‘½ä¸€ä¸ªå›½ç‹
  King createKing();
  //ç»™ç‹å›½åˆ›å»ºä¸€æ”¯å†›é˜Ÿ
  Army createArmy();
}

//åˆ›å»ºç²¾çµç‹å›½å·¥å‚çš„å…·ä½“å®ç°
public class ElfKingdomFactory implements KingdomFactory {

  @Override
  public Castle createCastle() {
    return new ElfCastle();
  }

  @Override
  public King createKing() {
    return new ElfKing();
  }

  @Override
  public Army createArmy() {
    return new ElfArmy();
  }
}

//åˆ›å»ºå…½äººç‹å›½å·¥å‚çš„å…·ä½“å®ç°
public class OrcKingdomFactory implements KingdomFactory {

  @Override
  public Castle createCastle() {
    return new OrcCastle();
  }

  @Override
  public King createKing() {
    return new OrcKing();
  }
  
  @Override
  public Army createArmy() {
    return new OrcArmy();
  }
}
```

ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªæŠ½è±¡å·¥å‚ï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³å¯¹è±¡ï¼Œå³ç²¾çµç‹å›½å·¥å‚åˆ›å»ºç²¾çµåŸå ¡ã€å›½ç‹å’Œå†›é˜Ÿç­‰ã€‚

```java
var factory = new ElfKingdomFactory();
var castle = factory.createCastle();
var king = factory.createKing();
var army = factory.createArmy();

castle.getDescription();
king.getDescription();
army.getDescription();
```

ç¨‹åºè¾“å‡º

```java
This is the elven castle!
This is the elven king!
This is the elven Army!
```

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæˆ‘ä»¬ä¸åŒçš„ç‹å›½è®¾è®¡å·¥å‚ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†`FactoryMaker`ï¼Œè´Ÿè´£è¿”å›`ElfKingdomFactory`æˆ–`OrcKingdomFactory`çš„å®ä¾‹ã€‚
å®¢æˆ·ç«¯ï¼ˆè°ƒç”¨æ–¹ï¼‰å¯ä»¥ä½¿ç”¨`FactoryMake`åˆ›å»ºæ‰€éœ€çš„å·¥å‚ï¼Œè¿›è€Œç”Ÿäº§ä¸åŒçš„å·¥å‚å¯¹è±¡ã€‚
åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨äº†ä¸€ä¸ªæšä¸¾æ¥å‚æ•°åŒ–å®¢æˆ·ç«¯çš„ç‹å›½å·¥å‚çš„ç±»å‹ã€‚

```java
public static class FactoryMaker {

  public enum KingdomType {
    ELF, ORC
  }

  public static KingdomFactory makeFactory(KingdomType type) {
    switch (type) {
      case ELF:
        return new ElfKingdomFactory();
      case ORC:
        return new OrcKingdomFactory();
      default:
        throw new IllegalArgumentException("KingdomType not supported.");
    }
  }
}

public static void main(String[] args) {
  var app = new App();

  LOGGER.info("å¼€å§‹åˆ›å»ºç²¾çµç‹å›½");
  app.createKingdom(FactoryMaker.makeFactory(KingdomType.ELF));
  LOGGER.info(app.getArmy().getDescription());
  LOGGER.info(app.getCastle().getDescription());
  LOGGER.info(app.getKing().getDescription());

  LOGGER.info("å¼€å§‹åˆ›å»ºå…½äººç‹å›½");
  app.createKingdom(FactoryMaker.makeFactory(KingdomType.ORC));
  -- similar use of the orc factory
}
```

## ç±»å›¾

![abstract-factory.urm](https://zhz-img.oss-cn-hangzhou.aliyuncs.com/img/abstract-factory.urm.png)


## é€‚ç”¨åœºæ™¯

- ç³»ç»Ÿåº”ç‹¬ç«‹äºå…¶äº§å“çš„åˆ›å»ºã€ç»„æˆå’Œè¡¨ç¤ºæ–¹å¼

- ç³»ç»Ÿåº”é…ç½®å¤šä¸ªäº§å“ç³»åˆ—ä¸­çš„ä¸€ä¸ª
- ç›¸å…³äº§å“å¯¹è±¡éœ€å¿…é¡»è¦åœ¨ä¸€èµ·ä½¿ç”¨ï¼Œéœ€è¦ä¿è¯äº§å“ä¸€è‡´æ€§æ—¶

- æ‚¨æƒ³æä¾›äº§å“çš„ç±»åº“ï¼Œå¹¶ä¸”åªæƒ³æ˜¾ç¤ºå®ƒä»¬çš„æ¥å£ï¼Œè€Œä¸æ˜¯å…·ä½“çš„å®ç°

- åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œæ¥æ„é€ ç‰¹å®šçš„ä¾èµ–é¡¹æˆ–è°ƒç”¨é‚£ä¸ªäº§å“

- åœ¨å‘ç¨‹åºä¸­æ·»åŠ æ–°äº§å“æˆ–äº§å“ç³»åˆ—æ—¶ï¼Œæ‚¨ä¸å¸Œæœ›æ›´æ”¹ç°æœ‰ä»£ç ã€‚

## ä¼˜ç‚¹

- å…·ä½“äº§å“åœ¨åº”ç”¨å±‚çš„ä»£ç éš”ç¦»ï¼Œæ— éœ€å…³ç³»åˆ›å»ºçš„ç»†èŠ‚
- å°†ä¸€ä¸ªç³»åˆ—çš„äº§å“ç»Ÿä¸€åˆ°ä¸€èµ·åˆ›å»º

## ç¼ºç‚¹

- javaä¸­çš„ä¾èµ–æ³¨å…¥éšè—äº†æœåŠ¡ç±»ä¾èµ–é¡¹ï¼Œè¿™äº›ä¾èµ–é¡¹å¯èƒ½ä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯åœ¨ç¼–è¯‘æ—¶å°±è¢«æ•è·

- è™½ç„¶åœ¨åˆ›å»ºé¢„å®šä¹‰å¯¹è±¡æ—¶éå¸¸æœ‰ç”¨ï¼Œä½†æ·»åŠ æ–°å¯¹è±¡ï¼ˆæ‰©å±•æ–°äº§å“ï¼‰å¯èƒ½ä¼šå¾ˆå¤æ‚

- ç”±äºå¤§é‡æ–°æ¥å£å’Œç±»ä¸æ¨¡å¼ä¸€èµ·å¼•å…¥ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„æŠ½è±¡æ€§å’Œç†è§£éš¾åº¦

## å…¶å®ƒæ•™ç¨‹

* [Abstract Factory Pattern Tutorial](https://www.journaldev.com/1418/abstract-factory-design-pattern-in-java) 
* [Factory Method](https://java-design-patterns.com/patterns/factory-method/)
* [Factory Kit](https://java-design-patterns.com/patterns/factory-kit/)

## ç»å…¸æ¡ˆä¾‹

* [javax.xml.parsers.DocumentBuilderFactory](http://docs.oracle.com/javase/8/docs/api/javax/xml/parsers/DocumentBuilderFactory.html)
* [javax.xml.transform.TransformerFactory](http://docs.oracle.com/javase/8/docs/api/javax/xml/transform/TransformerFactory.html#newInstance--)
* [javax.xml.xpath.XPathFactory](http://docs.oracle.com/javase/8/docs/api/javax/xml/xpath/XPathFactory.html#newInstance--)
* [javax.xml.bind.JAXBContext](https://docs.oracle.com/javase/8/docs/api/javax/xml/bind/JAXBContext.html#createMarshaller--)
* [java.util.Calendar](http://docs.oracle.com/javase/8/docs/api/java/util/Calendar.html#getInstance--)
* [java.util.ResourceBundle](http://docs.oracle.com/javase/8/docs/api/java/util/ResourceBundle.html#getBundle-java.lang.String-)
* [java.text.NumberFormat](http://docs.oracle.com/javase/8/docs/api/java/text/NumberFormat.html#getInstance--)
* [java.nio.charset.Charset](http://docs.oracle.com/javase/8/docs/api/java/nio/charset/Charset.html#forName-java.lang.String-)
* [java.net.URLStreamHandlerFactory](http://docs.oracle.com/javase/8/docs/api/java/net/URLStreamHandlerFactory.html#createURLStreamHandler-java.lang.String-)
* [java.util.EnumSet](https://docs.oracle.com/javase/8/docs/api/java/util/EnumSet.html#of-E-)

## è·å–æºç 

ğŸ‘‰[æ›´å¤šè®¾è®¡æ¨¡å¼çš„æºç ï¼Œéƒ½æ•´ç†åˆ°githupä¸Šäº†](https://github.com/EasonHz/java-design-patterns-cn)
